<!doctype html>
<html>
<head>
  <meta charset="utf-8">
<title>Io操作 | Michael Zhang</title>
<meta name="author" content="Michael Zhang">


<link rel="shortcut icon" href="/public/img/deer3.png" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="/public/css/bootstrap.css">
<link rel="stylesheet" href="/public/css/font-awesome.css">
<link rel="stylesheet" href="/public/js/prettify/prettify.css">
<link rel="stylesheet" href="/public/css/base.css">
<link href="/pages/atom.xml" rel="alternate" title="Michael Zhang" type="application/atom+xml">
</head>
<body>
  <div class="container">
    <div class="row">
      <div class="col-md-3 col-lg-3 col-sm-13 col-xs-13 aside visible-md visible-lg">
  <div class="row">
    <div class="col-md-2 col-xs-2 aside1">
      <br>
      <a class="pjaxlink" href="/"><img src="/public/img/deer3.png" class="img-ronuded avatar" style="border-width:0px; border-color:#000"></a>
      <br><br><br><br>
      <ul class="nav nav-pills nav-stacked" id="ul_category">
        <!-- collect all categories -->
        
         <li><a href="#Linux" data-toggle="tab">Linux</a></li>
        
         <li><a href="#软件使用" data-toggle="tab">软件使用</a></li>
        
         <li><a href="#环境搭建" data-toggle="tab">环境搭建</a></li>
        
        <li><a data-toggle="tab" href="#tags">标签</a></li>
      </ul>
      <div class="aside1_bottom">
        <ul class="nav nav-pills nav-stacked" id="ul_about">
          <li><a class="pjaxlink" href="/pages/archive.html">存档</a></li>
          <li><a class="pjaxlink" href="/pages/about.html">关于</a></li>
        </ul>
          <table class="table table-condensed">
          <tr>
            <td><a href="mailto:zjj421work@163.com"><i class="fa fa-envelope-o fa-lg" style="color:#fff;"></i></a></td>
            <td><a href="http://github.com/zjj421" target="_blank"><i class="fa fa-github fa-lg" style="color:#fff;"></i></a></td>
          </tr>
        </table>
      </div>
    </div>
    <div class="col-md-10 col-xs-10 aside2" id="div_tab">
      <div class="row">
        <div class="tab-content">
          
            <div class="tab-pane" id="Linux">
              <div class="list-group">
                <!-- collect all articles under this category -->
                
                  <a href="/2017/08/06/Basic_knowledge_of_Linux.html" class="list-group-item-terry pjaxlink">Basic knowledge of Linux</a>
                
                  <a href="/2017/08/05/ubuntu16.04%E8%BF%9E%E6%8E%A5AWS-EC2.html" class="list-group-item-terry pjaxlink">ubuntu16.04连接AWS EC2</a>
                
                  <a href="/2017/08/04/Ubuntu16.04%E5%AE%89%E8%A3%85node.js.html" class="list-group-item-terry pjaxlink">Ubuntu16.04 安装node.js并配置</a>
                
              </div>
            </div>
          
            <div class="tab-pane" id="软件使用">
              <div class="list-group">
                <!-- collect all articles under this category -->
                
                  <a href="/2017/08/05/Atom%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8.html" class="list-group-item-terry pjaxlink">Atom简单使用</a>
                
              </div>
            </div>
          
            <div class="tab-pane" id="环境搭建">
              <div class="list-group">
                <!-- collect all articles under this category -->
                
                  <a href="/2017/08/06/ubuntu16.04%E5%AE%89%E8%A3%85gpu%E7%89%88tensorflow-keras.html" class="list-group-item-terry pjaxlink">ubuntu16.04安装gpu版tensorflow＋keras</a>
                
              </div>
            </div>
          
          <div class="tab-pane" id="tags">
            <div class="panel-group" id="accordion">
              <!-- collect all tags -->
              
                <div class="panel panel-info panel-terry">
                  <div class="panel-heading">
                    <h4 class="panel-title">
                      <a data-toggle="collapse" data-toggle="collapse" data-parent="#accordion" href="#Linux">Linux</a>
                      <span class="badge pull-right">3</span>
                    </h4>
                  </div>
                  <div id="Linux" class="panel-collapse collapse">
                    <!-- collect all articles with this tag -->
                    
                      <a  href='/2017/08/06/Basic_knowledge_of_Linux.html' class="list-group-item-terry  pjaxlink">
                        Basic knowledge of Linux
                      </a>
                    
                      <a  href='/2017/08/05/ubuntu16.04%E8%BF%9E%E6%8E%A5AWS-EC2.html' class="list-group-item-terry  pjaxlink">
                        ubuntu16.04连接AWS EC2
                      </a>
                    
                      <a  href='/2017/08/04/Ubuntu16.04%E5%AE%89%E8%A3%85node.js.html' class="list-group-item-terry  pjaxlink">
                        Ubuntu16.04 安装node.js并配置
                      </a>
                    
                  </div>
                </div>
              
                <div class="panel panel-info panel-terry">
                  <div class="panel-heading">
                    <h4 class="panel-title">
                      <a data-toggle="collapse" data-toggle="collapse" data-parent="#accordion" href="#软件使用">软件使用</a>
                      <span class="badge pull-right">1</span>
                    </h4>
                  </div>
                  <div id="软件使用" class="panel-collapse collapse">
                    <!-- collect all articles with this tag -->
                    
                      <a  href='/2017/08/05/Atom%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8.html' class="list-group-item-terry  pjaxlink">
                        Atom简单使用
                      </a>
                    
                  </div>
                </div>
              
                <div class="panel panel-info panel-terry">
                  <div class="panel-heading">
                    <h4 class="panel-title">
                      <a data-toggle="collapse" data-toggle="collapse" data-parent="#accordion" href="#环境搭建">环境搭建</a>
                      <span class="badge pull-right">1</span>
                    </h4>
                  </div>
                  <div id="环境搭建" class="panel-collapse collapse">
                    <!-- collect all articles with this tag -->
                    
                      <a  href='/2017/08/06/ubuntu16.04%E5%AE%89%E8%A3%85gpu%E7%89%88tensorflow-keras.html' class="list-group-item-terry  pjaxlink">
                        ubuntu16.04安装gpu版tensorflow＋keras
                      </a>
                    
                  </div>
                </div>
              
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

      <div class="col-md-13 col-lg-13 col-sm-13 col-xs-13 aside3">
        <div id="container">
          <div id="pjax">
            <div class="row">
  <div class="col-md-13 aside3-title">
    <br>
    <h2 id="#identifier">Io操作</h2>
    <p class="text-right">2017-08-13</p>
  </div>
  <div class="col-md-13 aside3-content">
    <div id="content">
      <h1 id="io编程">IO编程</h1>

<h2 id="文件读写">文件读写</h2>

<h3 id="读文件">读文件</h3>
<div class="highlighter-rouge"><pre class="highlight"><code>  f = open("/home/username/test.txt", "r")  # 在内存中打开文件
  f.read()  # 一次性读取文件的全部内容
  f.close  # 关闭文件
</code></pre>
</div>
<ul>
  <li>符号“r”表示读，默认读utf-8编码的文本文件，如果要读图片、视频等二进制文件，则用”rb”代替。</li>
  <li>如果文件不存在，会报IOError的错误。一旦出错，f.close()就不会被调用。最好的方式是用with语句来帮我们自动关闭文件。
    <div class="highlighter-rouge"><pre class="highlight"><code>with open("/home/username/test.txt", "r") as f:
    print(f.read())
</code></pre>
    </div>
  </li>
  <li>对于大文件，不能一次性读取所有内容，可以反复调用read(size)方法，每次最多读取size字节的内容。或者调用readline()方法，每次读取一行内容；也可以调用readlines()方法，一次读取所有内容并按行返回一个list。
    <div class="highlighter-rouge"><pre class="highlight"><code>for line in f.readlines()：
    print(line.strip())  # strip()方法可以去掉首尾的空格。
</code></pre>
    </div>
  </li>
  <li>
    <p>像open()函数返回的这种有个read()方法的对象，在Python中统称为file-like Object。除了file外，还可以是内存的字节流，网络流，自定义流等等。file-like Object不要求从特定类继承，只要写个read()方法就行。</p>
  </li>
  <li>对于特定编码的文本文件，需要给open()函数传入encoding参数。</li>
</ul>

<h2 id="写文件">写文件</h2>
<div class="highlighter-rouge"><pre class="highlight"><code>  with open("/home/username/test.txt", "w[b]") as f:
      f.write("Hello World!")
</code></pre>
</div>
<ul>
  <li><strong>只有文件关闭之后，对文件所作的更改才能保存到磁盘上。</strong></li>
</ul>

<h2 id="操作文件和目录">操作文件和目录</h2>

<h2 id="常用的">常用的</h2>

<ul>
  <li>os.path.join(“/home/username/test”, “test.txt”)
    <ul>
      <li>拼接字符串，结果为/home/usrname/test/test.txt</li>
      <li>根据系统来确定拼接符是“/”(Linux)还是“\”(Windows).</li>
      <li>操作的是字符串，不需要真实的路径。</li>
    </ul>
  </li>
  <li>os.path.split(“/home/username/test.txt”)
    <ul>
      <li>可拆分出文件名</li>
      <li>返回父目录和文件名或目录名，总共两个字符串。</li>
      <li>上面返回(“/home/username”, “test.txt”)</li>
      <li><em>字符串的split(arg)方法，是根据传入的原字符串中的字符拆分原字符串，返回多个字符串。</em></li>
    </ul>
  </li>
  <li>os.path.splitext(“filename.txt”)
    <ul>
      <li>可拆分出后缀名</li>
      <li>返回(“filenam”,”.txt”)</li>
    </ul>
  </li>
  <li>os.path.exists(“/home/username/test.txt”)
    <ul>
      <li>判断路径是否存在</li>
    </ul>
  </li>
  <li>os.path.abspath(“.”)
    <ul>
      <li>查看当前目录的绝对路径</li>
    </ul>
  </li>
  <li>os.mkdir(“/home/usrname/newdir”)
    <ul>
      <li>新建目录</li>
    </ul>
  </li>
  <li>os.rmdir(“/home/usrname/abandoneddir”)
    <ul>
      <li>删除目录</li>
    </ul>
  </li>
  <li>os.rename(“/home/username/oldname”, “/home/usrname/newname”)
    <ul>
      <li>重命名，<strong>要求第一个参数表示的路径真实存在，第二个表示的路径不存在。</strong></li>
      <li>可以把原文件复制到新的地方，并可重命名。</li>
    </ul>
  </li>
  <li>os.remove(“/home/usrname/abandonedfile”)
    <ul>
      <li>删除文件</li>
    </ul>
  </li>
</ul>

<h2 id="操作excel">操作excel</h2>

<h3 id="xlrd读xls或者xlsx文件">xlrd　读.xls或者.xlsx文件</h3>
<div class="highlighter-rouge"><pre class="highlight"><code>import xlrd
import xlwt
import os
from xlutils.copy import copy

def readexcel():
    book = xlrd.open_workbook("/home/zj/桌面/test02allsimilarities.xls")
    # table = data.sheets()[0]
    sheet = book.sheet_by_index(0)  # 获取索引值为0的表单。
    # sheet = data.sheet_by_name("sheetname")  # 根据表单名获取表单。
    i = 1  # 索引都是从０开始的
    print(sheet.row_values(i))  # 返回包含第i+1行的值的list
    c = sheet.col_values(i)  # 返回包含第i+1列的值的list
    nrows = sheet.nrows  # 返回表单现有数据的行数
    ncols = sheet.ncols  # 返回表单现有数据的列数
    # print(ncols)
    cell_C4 = sheet.cell(3, 2).value  # 获取单元格C4的值，其索引为(4-3,2), C表示列的索引值。
    # print(cell_C4)
    cell_B3 = sheet.row(2)[1].value  # 根据行列来索引
    # print(cell_B3)
    # print(nrows)
    # cell_C4 = table.cell_value(3, 2)  # 获取单元格C4的值
    print(cell_C4)

def write_new_excel():
    workbook = xlwt.Workbook()  # 新建工作簿
    wsheet = workbook.add_sheet("sheetname")  # 添加工作表
    wsheet.write(1, 1, "单元格的值")  # 表单中写入新的值，这里可以设置相关的格式
    workbook.save("filename_path")  # 保存


def write_to_old_or_new_excel(filename_path):
    # 判断该工作不是否存在，不存在就新建一个工作簿，并添加新的表单。
    if not os.path.exists(filename_path):
        w = xlwt.Workbook()
        ws = w.add_sheet("sheetname")
        w.save(filename_path)
    rexcel = xlrd.open_workbook(filename_path)  # 打开工作簿
    wexcel = copy(rexcel)  # 复制工作簿，从打开的xlrd的Book变量中，拷贝到xlwt的Workbook变量中。
    wsheet = wexcel.get_sheet(0)  # 从Workbook变量中获得对应索引的表单，
    xlwt.write(2, 2, "value")  # 写数据
    rexcel.save(filename_path)  # 保存
</code></pre>
</div>

    </div>
  </div>
  <div id="content_table" style="position:fixed;right:20px;top:120px;display:none;">
    <div class="panel panel-success">
      <div class="panel-body" id="nav"></div>
    </div>
  </div>
</div>

          </div>
        </div>
      </div>
    </div>
  </div>
  <script type="text/javascript" src="/public/js/jquery.js"></script>
<script type="text/javascript" src="/public/js/bootstrap.js"></script>
<script src="/public/js/jquery.pjax.js"></script>
<script src="/public/js/prettify/prettify.js"></script>
<script src="/public/js/base.js"></script>
<script>
    $('a[href="#coding"]').tab('show');
</script>


  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-54262064-1', 'zjj421.github.io');
  ga('send', 'pageview');
</script>
</body>
</html>